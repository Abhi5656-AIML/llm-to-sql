ğŸ§  Natural Language â†’ SQL Analytics System (Production-Grade)
A production-ready Natural Language to SQL (NLâ†’SQL) analytics system that allows users to query a MySQL database using plain English â€” with strict safety guardrails, clarification handling, evaluation metrics, and a web UI.
Unlike toy NLâ†’SQL demos, this system is deterministic, hallucination-resistant, and interview-ready.
ğŸš€ Key Features
ğŸ” Natural Language â†’ SQL generation
ğŸ›¡ï¸ Strict guardrails (no hallucinated columns, tables, or filters)
â“ Clarification engine for ambiguous queries (e.g., â€œtop storesâ€)
ğŸ§  Conversation-aware resolution (handles follow-ups correctly)
ğŸ“Š MySQL-dialect-safe SQL
ğŸ§ª Automated evaluation & regression testing
ğŸŒ FastAPI backend
ğŸ–¥ï¸ Web UI for interactive querying
ğŸ³ Dockerized & cloud-ready
ğŸ§© System Architecture
User Query
   â†“
Ambiguity Detection (STRICT MODE)
   â†“
Clarification Engine (if needed)
   â†“
Schema-Aware LLM (Qwen2.5-32B)
   â†“
SQL Guardrails (syntax + semantic)
   â†“
Safe SQL Execution (MySQL)
   â†“
Natural Language Explanation
   â†“
Evaluation & Metrics
ğŸ—ï¸ Project Structure
LLM-to-SQL/
â”‚
â”œâ”€â”€ main.py                    # Unified FastAPI app (API + UI)
â”œâ”€â”€ run.py                     # App runner
â”œâ”€â”€ nl_to_sql_pipeline.py      # Core NL â†’ SQL pipeline
â”œâ”€â”€ sql_guardrails.py          # SQL safety & validation
â”œâ”€â”€ clarification_engine.py    # Ambiguity detection & handling
â”œâ”€â”€ conversation_state.py      # Conversation memory
â”œâ”€â”€ explanation_prompt.py      # Result explanation logic
â”œâ”€â”€ evaluation_metrics.py      # Metrics computation
â”œâ”€â”€ test_cases.py              # Golden test cases
â”œâ”€â”€ run_evaluation.py          # Evaluation runner
â”‚
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html             # Web UI
â”‚
â”œâ”€â”€ Dockerfile                 # Docker configuration
â”œâ”€â”€ requirements.txt           # Python dependencies
â””â”€â”€ README.md
ğŸ§  Design Principles
âŒ What this system does NOT do
No implicit defaults
No guessing missing metrics
No hallucinated filters (e.g., random cities)
No unsafe SQL execution
âœ… What this system guarantees
Deterministic behavior
Explicit clarification for ambiguity
Schema-grounded SQL only
Zero unsafe queries
ğŸ›¡ï¸ Strict Clarification Policy
Queries like:
Show top stores
Are intentionally blocked until clarified:
Top by which metric (total revenue, number of orders, or return rate)?
This prevents silent semantic drift, which is critical in analytics systems.
ğŸ§ª Evaluation Metrics (Phase 8)
Example output:
{
  "total_tests": 5,
  "success_rate": 0.6,
  "clarification_rate": 0.4,
  "error_rate": 0.0
}
Interpretation:
60% success â†’ well-specified queries
40% clarification â†’ ambiguous queries handled safely
0% error rate â†’ no hallucinations or unsafe SQL
This is expected and desirable in production BI systems.
ğŸŒ Web UI
Input natural language queries
View:
Generated SQL
Query results
Natural language explanation
Handles clarification & follow-ups interactively
ğŸ§‘â€ğŸ’» API Usage
Endpoint
POST /query
Request
{
  "query": "Show total revenue per city in the last 6 months"
}
Response
{
  "status": "success",
  "sql": "...",
  "result": {...},
  "explanation": "..."
}
âš™ï¸ Running Locally
1ï¸âƒ£ Install dependencies
pip install -r requirements.txt
2ï¸âƒ£ Start the app
python run.py
Open:
http://127.0.0.1:8000
ğŸ³ Docker Deployment (Phase 11)
Build image
docker build -t nl-sql-app .
Run container
docker run -p 8000:8000 nl-sql-app
â˜ï¸ Cloud Deployment
This Docker image can be deployed on:
Railway
Render
AWS EC2
GCP Cloud Run
Azure Container Apps
ğŸ§  Model Choice
LLM: Qwen2.5-32B
Reason:
Strong SQL reasoning
Open-source & self-hostable
Works well with schema grounding
Guardrails ensure correctness over raw model behavior
ğŸ” Security & Safety
SELECT-only SQL enforcement
Schema-aware identifier validation
No inferred filters or locations
Execution time & result size limits
ğŸ“Œ Interview-Ready Highlights
You can confidently say:
â€œI built a production-grade NLâ†’SQL analytics system with strict clarification gating, SQL safety guardrails, automated evaluation, and a deployable FastAPI interface.â€
ğŸ Status
âœ… End-to-end implemented
âœ… Production-credible
âœ… Fully evaluated
âœ… Dockerized & deployable
ğŸ“ˆ Future Enhancements
Role-based access control
Query caching
Multi-database support
Cost-based model routing
Streaming responses